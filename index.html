<!doctype html>
<html lang="en">
  <head>
    <title>Prayer Time</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1280" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <link href="bootstrap.min.css" rel="stylesheet" />
    <script src="jquery.min.js"></script>
    <script src="bootstrap.min.js"></script>

    <!-- Template Main CSS File -->
    <link href="style.css" rel="stylesheet" />

    <!-- PRAYER TIME -->
    <script type="text/javascript" src="PrayTimes.js"></script>
    <!-- video-background --->
    <video autoplay muted loop id="video-background">
      <source src="./videos/bg-masjid.mp4" type="video/mp4" />
      <!-- Add additional source elements for other video formats if needed -->
    </video>

    <script type="text/javascript">
      function stopAdzan() {
        var adzanVideo = document.getElementById("adzan-video");
        var adzanSubuhVideo = document.getElementById("adzan-subuh-video");
        adzanVideo.pause();
        adzanSubuhVideo.pause();
        adzanVideo.currentTime = 0;
        adzanSubuhVideo.currentTime = 0;
      }
      function showModalAdzan(prayer) {
        var prayerTitle = document.getElementById("prayer-modal-title");
        var adzanVideo = document.getElementById("adzan-video");
        var adzanSubuhVideo = document.getElementById("adzan-subuh-video");
        var timeout = 222000;
        stopAdzan();

        if (prayer == "Subuh") {
          timeout = 150000;
          adzanSubuhVideo.play();
          $("#ModalAzanSubuh").modal("show");
        } else {
          adzanVideo.play();
          $("#ModalAzan").modal("show");
        }

        setTimeout(function () {
          $(".close-modal").click();
        }, timeout);
      }

      var lastAdzanTime = ""; // Variable to track the last triggered prayer time

      function waktuSholat() {
        var today = new Date();
        var h = today.getHours();
        var m = today.getMinutes();
        var s = today.getSeconds();
        h = checkTime(h);
        m = checkTime(m);
        s = checkTime(s);

        var date = today.getDate();
        var month = today.getMonth();
        var montharr = [
          "Januari",
          "Februari",
          "Maret",
          "April",
          "Mei",
          "Juni",
          "Juli",
          "Agustus",
          "September",
          "Oktober",
          "November",
          "Desember",
        ];
        month = montharr[month];
        var year = today.getFullYear();

        var day = today.getDay();
        var dayarr = [
          "Minggu",
          "Senin",
          "Selasa",
          "Rabu",
          "Kamis",
          "Jumat",
          "Sabtu",
        ];
        day = dayarr[day];

        document.getElementById("jam").innerHTML = h + ":" + m + ":" + s;
        document.getElementById("hari").innerHTML = day + ",";
        document.getElementById("tgl").innerHTML =
          date + " " + month + " " + year;

        // MANUAL SETTINGS --------------------------------------------------------
        prayTimes.setMethod("MWL"); // perhitungan
        var Ptimes = prayTimes.getTimes(today, [35.124906, 126.767932], 9); // Gwangju (longitude, Latitude, Time Zone)
        // ------------------------------------------------------------------------
        document.getElementById("imsak").innerHTML = Ptimes.imsak;
        document.getElementById("subuh").innerHTML = Ptimes.fajr;
        document.getElementById("terbit").innerHTML = Ptimes.sunrise;
        document.getElementById("zuhur").innerHTML = Ptimes.dhuhr;
        document.getElementById("ashar").innerHTML = Ptimes.asr;
        document.getElementById("maghrib").innerHTML = Ptimes.maghrib;
        document.getElementById("isya").innerHTML = Ptimes.isha;

        // Azan

        var waktu = h + ":" + m;

        // Check if current time matches any prayer time AND we haven't triggered it yet for this time
        if (lastAdzanTime !== waktu) {
            if (waktu == Ptimes.fajr) {
                lastAdzanTime = waktu;
                showModalAdzan("Subuh");
            } else if (waktu == Ptimes.dhuhr) {
                lastAdzanTime = waktu;
                showModalAdzan("Dzuhur");
            } else if (waktu == Ptimes.asr) {
                lastAdzanTime = waktu;
                showModalAdzan("Ashar");
            } else if (waktu == Ptimes.maghrib) {
                lastAdzanTime = waktu;
                showModalAdzan("Maghrib");
            } else if (waktu == Ptimes.isha) {
                lastAdzanTime = waktu;
                showModalAdzan("Isya");
            }
        }

        // colors

        var akhirwaktu = "23:59";

        function updateActivePrayer(id, isActive) {
          var el = document.getElementById(id);
          if (isActive) {
            el.classList.add("active-prayer");
            // Remove inline styles from legacy code
            el.style.backgroundColor = "";
          } else {
            el.classList.remove("active-prayer");
            el.style.backgroundColor = "";
          }
        }

        if (waktu >= Ptimes.imsak && waktu < Ptimes.fajr) {
          updateActivePrayer("cimsak", true);
        } else {
          updateActivePrayer("cimsak", false);
        }
        if (waktu >= Ptimes.fajr && waktu < Ptimes.sunrise) {
          updateActivePrayer("csubuh", true);
        } else {
          updateActivePrayer("csubuh", false);
        }

        if (waktu >= Ptimes.sunrise && waktu < Ptimes.dhuhr) {
          updateActivePrayer("cterbit", true);
        } else {
          updateActivePrayer("cterbit", false);
        }

        if (waktu >= Ptimes.dhuhr && waktu < Ptimes.asr) {
          updateActivePrayer("czuhur", true);
        } else {
          updateActivePrayer("czuhur", false);
        }

        if (waktu >= Ptimes.asr && waktu < Ptimes.maghrib) {
          updateActivePrayer("cashar", true);
        } else {
          updateActivePrayer("cashar", false);
        }

        if (waktu >= Ptimes.maghrib && waktu < Ptimes.isha) {
          updateActivePrayer("cmaghrib", true);
        } else {
          updateActivePrayer("cmaghrib", false);
        }
        if (waktu >= Ptimes.isha && waktu < akhirwaktu) {
          updateActivePrayer("cisya", true);
        } else {
          updateActivePrayer("cisya", false);
        }

        var t = setTimeout(waktuSholat, 1000);
      }
      function checkTime(i) {
        if (i < 10) {
          i = "0" + i;
        } // add zero in front of numbers < 10
        return i;
      }
    </script>
  </head>

  <body onload="waktuSholat()">
    <div class="container-fluid">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-custom">
        <a class="navbar-brand font-weight-bold" href="#">
          <img
            src="img/logomasjid.png"
            width="30"
            height="30"
            class="d-inline-block align-top mr-2"
            alt=""
          />
          Masjid Al Ishlah
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a
                class="nav-link"
                href="#"
                data-toggle="modal"
                data-target="#ModalQuran"
                >Al-Quran</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="#"
                data-toggle="modal"
                data-target="#ModalSearch"
                >Pencarian</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link btn-cta"
                href="#"
                data-toggle="modal"
                data-target="#ModalDonasi"
                >Donasi</a
              >
            </li>
          </ul>
        </div>
      </nav>

      <!-- Header with Clock -->
      <div class="row header">
        <div class="col-md-8 text-left">
          <div class="date-info">
            <span class="hari" id="hari"></span>
            <span class="tgl" id="tgl"></span>
          </div>
        </div>
        <div class="col-md-4 text-right">
          <div class="jam" id="jam"></div>
        </div>
      </div>

      <!-- Main Content Quote -->
      <!-- <div class="row isi">
        <div class="col-md-12">
          <div class="quote-text">
            <h1>JAGALAH KEBERSIHAN<br />DI LINGKUNGAN MASJID</h1>
          </div> -->
        </div>
      </div>

      <!-- Footer with Prayer Times -->
      <div class="footer fixed-bottom">
        <div class="row justify-content-center">
          <div id="cimsak" class="col-sm">
            <img src="img/moon.png" width="30" height="30" alt="Imsak" />
            <h3>IMSAK</h3>
            <div id="imsak" class="jam2"></div>
          </div>
          <div id="csubuh" class="col-sm">
            <img src="img/moon.png" width="30" height="30" alt="Subuh" />
            <h3>SUBUH</h3>
            <div id="subuh" class="jam2"></div>
          </div>
          <div id="cterbit" class="col-sm">
            <img src="img/sunrise.png" width="30" height="30" alt="Terbit" />
            <h3>TERBIT</h3>
            <div id="terbit" class="jam2"></div>
          </div>
          <div id="czuhur" class="col-sm">
            <img src="img/sun.png" width="30" height="30" alt="Dzuhur" />
            <h3>DZUHUR</h3>
            <div id="zuhur" class="jam2"></div>
          </div>
          <div id="cashar" class="col-sm">
            <img src="img/sun.png" width="30" height="30" alt="Ashar" />
            <h3>ASHAR</h3>
            <div id="ashar" class="jam2"></div>
          </div>
          <div id="cmaghrib" class="col-sm">
            <img src="img/sunrise.png" width="30" height="30" alt="Maghrib" />
            <h3>MAGHRIB</h3>
            <div id="maghrib" class="jam2"></div>
          </div>
          <div id="cisya" class="col-sm">
            <img src="img/moon.png" width="30" height="30" alt="Isya" />
            <h3>ISYA</h3>
            <div id="isya" class="jam2"></div>
          </div>
        </div>

        <!-- Running Text -->
        <div class="row mt-3">
          <div class="col-md-12">
            <div class="bg-light">
              <marquee class="font-montserrat" scrollamount="6">
                Selamat Datang di Masjid Al Ishlah Pyeongdo - Mohon nonaktifkan
                alat komunikasi saat ibadah berlangsung.
              </marquee>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modals (Hidden) -->
    <div
      class="modal fade"
      id="ModalQuran"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Al-Quran Online</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true" style="color: white">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <iframe
              src="https://quran.com"
              width="100%"
              height="500px"
              style="border: none"
            ></iframe>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="ModalSearch"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Pencarian Google</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true" style="color: white">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form
              action="https://www.google.com/search"
              method="get"
              target="_blank"
            >
              <div class="input-group mb-3">
                <input
                  type="text"
                  class="form-control"
                  name="q"
                  placeholder="Cari sesuatu di Google..."
                  aria-label="Cari"
                  aria-describedby="button-addon2"
                />
                <div class="input-group-append">
                  <button
                    class="btn btn-primary"
                    type="submit"
                    id="button-addon2"
                  >
                    Cari
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="ModalDonasi"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Donasi Masjid</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true" style="color: white">&times;</span>
            </button>
          </div>
          <div class="modal-body text-center">
            <img
              src="img/qrcode.png"
              class="img-fluid mb-3"
              alt="QR Code Donasi"
              style="max-width: 200px"
            />
            <h5>Scan QR Code untuk Donasi</h5>
            <p>
              Bank Syariah Indonesia (BSI)<br />No. Rek: 1234567890<br />a.n.
              Masjid Al Ishlah
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Adzan (Video) -->
    <div
      class="modal fade"
      id="ModalAzan"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div
        class="modal-dialog modal-xl modal-dialog-centered"
        role="document"
        style="max-width: 90vw"
      >
        <div
          class="modal-content"
          style="background: transparent; border: none"
        >
          <div class="modal-body p-0">
            <button
              type="button"
              class="close close-modal"
              data-dismiss="modal"
              aria-label="Close"
              style="
                position: absolute;
                right: 15px;
                top: 10px;
                z-index: 100;
                color: white;
                opacity: 0.8;
              "
            >
              <span aria-hidden="true" style="font-size: 2rem">&times;</span>
            </button>
            <div class="video-container">
              <video id="adzan-video" controls>
                <source src="./videos/adzan.mp4" type="video/mp4" />
                Your browser does not support HTML5 video.
              </video>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="ModalAzanSubuh"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div
        class="modal-dialog modal-xl modal-dialog-centered"
        role="document"
        style="max-width: 90vw"
      >
        <div
          class="modal-content"
          style="background: transparent; border: none"
        >
          <div class="modal-body p-0">
            <button
              type="button"
              class="close close-modal"
              data-dismiss="modal"
              aria-label="Close"
              style="
                position: absolute;
                right: 15px;
                top: 10px;
                z-index: 100;
                color: white;
                opacity: 0.8;
              "
            >
              <span aria-hidden="true" style="font-size: 2rem">&times;</span>
            </button>
            <div class="video-container">
              <video id="adzan-subuh-video" controls>
                <source src="./videos/adzan-subuh.mp4" type="video/mp4" />
                Your browser does not support HTML5 video.
              </video>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
